<html>
  <head>
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js'></script>
  </head>
  <body>
    <script>
      var ws = new WebSocket("ws://" + document.domain + ":5000/ws");

      function joinGame() {
        var text, button;

        function sendName() {
          var name = text.val();
          if (name) {
            $("#game").empty();
            ws.send(name);
          }
        }

        text = $('<input name="playerName" type="text" />');
        button = $('<button name="playerJoin" type="button">Join</button>');
        button.click(sendName);
        $("#game").append(text).append(button);
      }

      ws.onmessage = function(message) {
        message = message.data;
        console.log("Message recieved: " + message);
        message = JSON.parse(message);
        if (message.type === 'join') {
          newHand(message.hand);
        } else if (message.type === 'round_start') {
          startRound(message.category, message.judge);
        }
      }

      ws.onclose = function() {
        console.log("Server disconnected");
      }

      function newHand(cards) {
        var i, hand;
        hand = $('<div class="hand" />');
        hand.append('<h1>Your hand:</h1>');
        for (i = 0; i < cards.length; ++i) {
          hand.append('<div class="card">' + cards[i] + '</div>');
        }
        $("#game").append(hand);
      }

      function startRound(category, judge) {
        var round;
        round = $('<div class="round" />');
        round.append('<h3>Judge: ' + judge + '</h3>');
        round.append('<h2>Category: ' + category + '</h2>');
        $("#game").append(round);
      }

      window.onload = joinGame;
    </script>
    <div id="game">
    </div>
  </body>
</html>
